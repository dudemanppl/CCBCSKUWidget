const t="www.competitivecyclist.com"===window.location.host,e=t?"cc":"bc",n=document.getElementById("pageType").content,o="plp"===n.slice(0,3)||"search"===n,c="pdp"===n,s=(t,e,n,o)=>{const c=document.createElement(t);return e&&c.classList.add(...e),n&&(c.id=n),o&&(c.textContent=o),c},r=t=>{const n=s("button",["chakra-button",e,"wms-button-pdp"]),o=s("a",["wms-link-pdp"],null,"Go to WMS");return n.setAttribute("type","button"),o.href=`https://manager.backcountry-apps.com/manager/admin/item_inventory.html?item_id=${t}`,n.append(o),n},i=()=>{const t=s("button",["chakra-button",e,"copy-sku-button-pdp"],null,"Copy SKU");return t.setAttribute("type","button"),t},a=()=>{const t=document.querySelectorAll('[itemprop="itemOffered"]'),e={};for(const n of t){const[{content:t},{content:o}]=n.children;let[c,s]=t.split(", ");if(s.endsWith("cm")){const t=s.substring(0,s.length-2);s=t}e[c]={...e[c],[s]:o}}return e},l=(t,e,n)=>{for(const o of t.children)e(o,n)},d=({lastChild:t},e={add:!0,classes:[]})=>{!1===e.add?t.classList.remove(...e.classes):t.classList.add(...e.classes)},p=t=>{l(t,d,{classes:["red-outline"]})},u=t=>{t.addEventListener("click",(()=>{l(t,d,{add:!1,classes:["red-outline"]})}),{once:!0})};if(c){let t;const e=i(),n=()=>{navigator.clipboard.writeText(t||"Error copying SKU"),e.textContent="Copied!"};e.onmouseleave=()=>{e.textContent="Copy SKU"};const o=document.getElementById("buybox-variant-selector").lastElementChild.lastChild;e.onclick=()=>{if(!JSON.parse(document.querySelector("#__NEXT_DATA__").innerText).props.pageProps.product.selectedSize){const e=JSON.parse(document.querySelector("#__NEXT_DATA__").innerText).props.pageProps.product.selectedSku;t=e,n()}else l(o,d,{classes:["red-outline"]}),u(o),e.textContent="Select a Size"};const c=document.getElementById("buybox-variant-selector").nextSibling.nextSibling,s=document.querySelector('[data-id="productId"]').innerText.slice(-7);c.append(r(s),e)}const m=()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("dropdown-caret"),t&&e.classList.add("cc"),e.setAttribute("viewBox","0 0 24 24");const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d","M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"),n.classList.add("caret-path"),e.append(n),e},y=({classList:[t]})=>"plp-dropdown-options"===t,g=async({currentTarget:t},n,o,c)=>{const{firstChild:r,lastChild:i}=t;if(y(i))i.classList.toggle("hidden");else{const i=s("UL",["plp-dropdown-options","hidden",e]);t.append(i),i.replaceWith(await T(n,r,o,c))}},S=t=>{t.classList.add("hidden")},v=t=>{const[e]=t.getElementsByTagName("img");return[e,t.querySelector('[data-id="productListingPrice"]')]},w=(t,e,n,o)=>{const[c,s]=v(e);n.onclick=e=>g(e,t,[c,s],o),e.onmouseleave=()=>{o.variantImgSrc&&(c.src=o.variantImgSrc);const[t]=e.getElementsByClassName("plp-dropdown-options");t&&t.classList.add("hidden")}},b=()=>s("div",["plp-dropdown-curr-selected-variant",e],null,"Select option"),h=(t,n)=>{const o=s("div",["plp-dropdown-container",e]);return o.append(s("div",["plp-dropdown-curr-selected-variant",e],null,"Select option"),m()),w(t,n,o,{currentlySelectedOptionIdx:-1,variantImgSrc:null}),o},f=async t=>(await fetch(t)).json(),k=async e=>{const n=`https://api.backcountry.com/v1/products/${e}?fields=skus.availability.stockLevel,skus.title,skus.id,skus.salePrice,skus.listPrice,skus.image&site=${t?"competitivecyclist":"bcs"}`;return await f(n)},x=async t=>{const e=await k(t),{products:[{skus:n}]}=e;return n},L=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t),C=({salePrice:e,listPrice:n,id:o,availability:{stockLevel:c},title:s,image:{url:r}})=>{const i=Math.round((n-e)/n*100);var a;return{price:(a=e,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(a)),discount:i,SKU:o,outOfStock:!c,variant:s,imageSrc:`https://content.${t?"competitivecyclist":"backcountry"}.com${r}`}},I=(t,e)=>{t.childNodes[e.currentlySelectedOptionIdx].classList.toggle("curr-selected-option")},_=(t,e,n)=>{n!==e.currentlySelectedOptionIdx&&(e.currentlySelectedOptionIdx>=0&&I(t,e),e.currentlySelectedOptionIdx=n,I(t,e))},E=async(t,e,n,o,c)=>(await x(t)).map(((t,s)=>U(C(t),o,e,n,(()=>_(c,o,s))))),T=async(...t)=>{const n=s("ul",["plp-dropdown-options",e]),o=await E(...t,n);return n.append(...o),n},A=(t,e,n)=>{if(t.textContent!==e){for(;t.lastChild;)t.lastChild.remove();t.textContent=e}},N=(t,e,n)=>{navigator.clipboard.writeText(n),t.classList.toggle("copy-notif"),t.textContent="SKU Copied!",setTimeout((()=>{t.classList.toggle("copy-notif"),t.textContent=e}),300)},O=(t,{price:e,discount:n,SKU:o,outOfStock:c,variant:s,imageSrc:r},i,a,[l,d],p)=>{c&&t.classList.add("oos-alert"),t.onmouseenter=()=>{l.src!==r&&(l.src=r)},t.onclick=()=>{p(),A(d,e),N(a,s,o),i.variantImgSrc=r}},U=(t,...e)=>{const{variant:n,price:o}=t,c=s("li",["plp-dropdown-option-single"],null,`${n} (${o})`);return O(c,t,...e),c},q=t=>{const n=s("a",["btn","btn-reset","plp","link-to-wms",e],null,"Go to WMS");return n.setAttribute("type","button"),n.href=`https://manager.backcountry-apps.com/manager/admin/item_inventory.html?item_id=${t}`,n},$=(t,n)=>{const o=s("div",["plp-widget-container",e]);return o.append(h(t,n),q(t)),o},P=e=>{const n=e.querySelector("img").src,o=t?60:53,c=[o,o+7],s=n.slice(...c),r=e.lastChild;r.append($(s,r))},B=()=>{const t=document.querySelectorAll('[data-id="productListingItems"]');for(const e of t)P(e)};if(o){B();const t=document.querySelector('[data-id="productsWrap"]');new MutationObserver((()=>B())).observe(t,{childList:!0})}