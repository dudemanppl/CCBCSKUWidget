const t="www.competitivecyclist.com"===window.location.host,e=t?"cc":"bc",n="plp"===document.getElementById("pageType").content.slice(0,3),o="pdp"===document.getElementById("pageType").content,c=(t,e,n,o)=>{const c=document.createElement(t);if(e){if(!Array.isArray(e))throw new TypeError("Expected an array");c.classList.add(...e)}return n&&(c.id=n),o&&(c.textContent=o),c},i=t=>{const e=c("a",r("WMSLink"),null,"Go to WMS");return e.setAttribute("type","button"),e.href=`https://manager.backcountry.com/manager/admin/item_inventory.html?item_id=${t}`,e},r=n=>{const c=[e],i=(...t)=>{c.push(...t)};return"WMSLink"!==n&&"CopySKUButton"!==n||(i("btn","btn-reset"),o?(i("pdp"),i(t?"btn--secondary":"product-buybox__btn")):i("plp")),"WMSLink"===n&&i("link-to-wms"),"PLPPrice"===n&&i("ui-pl-pricing__high-price","ui-pl-pricing--price-retail","js-item-price-high","qa-item-price-high"),c},s=({currentTarget:t})=>{const e=document.getElementsByClassName("js-selected-product-variant")[0].value;e?(navigator.clipboard.writeText(e),t.textContent="Copied!",t.classList.add("flash"),setTimeout((()=>{t.classList.remove("flash")}),100)):(t.textContent="Choose Item",t.classList.add("no-variant-selected"))},a=({currentTarget:t})=>{t.textContent="Copy SKU",t.classList.remove("no-variant-selected")},l=t=>{t.onmouseleave=a,t.onclick=s},d=()=>{const t=c("button",r("CopySKUButton"),"copy-sku-button","Copy SKU");return t.setAttribute("type","button"),l(t),t},p=t=>{const n=c("button",["chakra-button",e,"wms-button-pdp"]),o=c("a",["wms-link-pdp"],null,"Go to WMS");return n.setAttribute("type","button"),o.href=`https://manager.backcountry.com/manager/admin/item_inventory.html?item_id=${t}`,n.append(o),n},u=()=>{const t=c("button",["chakra-button",e,"copy-sku-button-pdp"],null,"Copy SKU");return t.setAttribute("type","button"),t},m=()=>{const t=document.querySelectorAll('[itemprop="itemOffered"]'),e={};for(const n of t){const[{content:t},{content:o}]=n.children,[c,i]=t.split(", ");e[c]={...e[c],[i]:o}}return e};if(o){let t;const e=u(),n=document.getElementById("buybox-variant-selector"),o=2===n.children.length,c=()=>{navigator.clipboard.writeText(t||"Error copying SKU")};if(o){const o=n.querySelector("ul");for(let e=0;e<o.children.length;e+=1){const n=o.children[e],c=n.getAttribute("value");0===e&&(t=c),n.onclick=()=>{t=c}}e.onclick=c}else{let o;const i=m(),r=n.lastChild.lastChild;if(1===r.childElementCount){const t=r.firstChild.firstChild.getAttribute("value");o=t}for(const t of r.children){const{firstChild:e,lastChild:n}=t,c=e.getAttribute("value");n.onclick=()=>{o=c}}e.onclick=()=>{const e=n.firstChild.lastChild.textContent,r=i[e][o];t=r,c()}}const i=document.getElementById("buybox-variant-selector").nextSibling.nextSibling,r=document.querySelector('[data-id="productId"]').innerText.slice(-7);i.append(p(r),e)}const y=()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add("dropdown-caret"),t&&e.classList.add("cc"),e.setAttribute("viewBox","0 0 256 256");const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d","M203.628 107.72c-5.613 5.9-64.759 63.566-64.759 63.566-3.007 3.149-6.939 4.714-10.87 4.714-3.945 0-7.876-1.567-10.87-4.714 0 0-59.145-57.665-64.773-63.565-5.613-5.9-6-16.501 0-22.812 6.014-6.296 14.386-6.79 21.738 0l53.905 52.908 53.891-52.894c7.365-6.79 15.752-6.296 21.738 0 6.014 6.296 5.641 16.912 0 22.797z"),n.classList.add("caret-path"),e.append(n),e},g=({classList:[t]})=>"plp-dropdown-options"===t,h=async({currentTarget:t},n,o,i)=>{const{firstChild:r,lastChild:s}=t;if(g(s))s.classList.toggle("hidden");else{const s=c("UL",["plp-dropdown-options","hidden",e]);t.append(s),s.replaceWith(await T(n,r,o,i))}},b=t=>{t.classList.add("hidden")},v=t=>{const[e]=t.getElementsByTagName("img"),[n]=t.getElementsByClassName("ui-pl-pricing");return[e,n]},S=(t,e,n,o)=>{const[c,i]=v(e);n.onclick=e=>h(e,t,[c,i],o),e.onmouseleave=()=>{o.variantImgSrc&&(c.src=o.variantImgSrc);const[t]=e.getElementsByClassName("plp-dropdown-options");t&&t.classList.add("hidden")}},w=()=>c("div",["plp-dropdown-curr-selected-variant",e],null,"Select option"),f=(t,n)=>{const o=c("div",["plp-dropdown-container",e]);return o.append(c("div",["plp-dropdown-curr-selected-variant",e],null,"Select option"),y()),S(t,n,o,{variantSelected:!1,currentlySelectedOptionIdx:-1,variantImgSrc:null}),o},k=async t=>(await fetch(t)).json(),C=async e=>{const n=`https://api.backcountry.com/v1/products/${e}?fields=skus.availability.stockLevel,skus.title,skus.id,skus.salePrice,skus.image&site=${t?"competitivecyclist":"bcs"}`;return await k(n)},L=async t=>{const e=await C(t),{products:[{skus:n}]}=e;return n},x=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(t),I=({salePrice:e,id:n,availability:{stockLevel:o},title:c,image:{url:i}})=>{var r;return{price:(r=e,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(r)),SKU:n,outOfStock:!o,variant:c,imageSrc:`https://content.${t?"competitivecyclist":"backcountry"}.com${i}`}},E=(t,e)=>{t.childNodes[e.currentlySelectedOptionIdx].classList.toggle("curr-selected-option")},U=(t,e,n)=>{n!==e.currentlySelectedOptionIdx&&(e.currentlySelectedOptionIdx>=0&&E(t,e),e.currentlySelectedOptionIdx=n,E(t,e))},A=async(t,e,n,o,c)=>(await L(t)).map(((t,i)=>N(I(t),o,e,n,(()=>U(c,o,i))))),T=async(...t)=>{const n=c("ul",["plp-dropdown-options",e]),o=await A(...t,n);return n.append(...o),n},B=(t,e,n)=>{navigator.clipboard.writeText(n),t.classList.toggle("copy-notif"),t.textContent="SKU Copied!",setTimeout((()=>{t.classList.toggle("copy-notif"),t.textContent=e}),300)},K=(t,{price:e,SKU:n,outOfStock:o,variant:c,imageSrc:i},r,s,[a,l],d)=>{o&&t.classList.add("oos-alert"),t.onmouseenter=()=>{a.src!==i&&(a.src=i)},t.onclick=()=>{d(),B(s,c,n),r.variantImgSrc=i}},N=(t,...e)=>{const{variant:n,price:o}=t,i=c("li",["plp-dropdown-option-single"],null,`${n} (${o})`);return K(i,t,...e),i},O=(t,n)=>{const o=c("div",["plp-widget-container",e]);return o.append(f(t,n),i(t)),o},$=e=>{const n=e.querySelector("img").src,o=t?60:53,c=[o,o+7],i=n.slice(...c),r=e.lastChild;r.append(O(i,r))},_=()=>{const t=document.querySelectorAll('[data-id="productListingItems"]');for(const e of t)$(e)};if(n){_();const t=document.querySelector('[data-id="productsWrap"]');new MutationObserver((()=>_())).observe(t,{childList:!0})}